<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:itm="http://java.sun.com/jsf/composite/components"
	template="/WEB-INF/templates/default.xhtml">



	<ui:define name="breadcrumb">
		<li class="breadcrumb-item"><a href="#">Home</a></li>
		<li class="breadcrumb-item"><a href="#{request.contextPath}/cliente">#{resources['label.global.cliente']}</a></li>
		<li class="breadcrumb-item"><a href="#{request.contextPath}/cliente/view/#{contratoViewController.contratoTO.contrato.cliente.id}">#{contratoViewController.contratoTO.contrato.cliente.nome}</a></li>
		<li class="breadcrumb-item active">#{contratoViewController.contratoTO.contrato.identificador}</li>
	</ui:define>
	<ui:param name="menu" value="cliente" />

	<ui:define name="corpo">
		<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.autenticacoes}">
			<script src="https://code.highcharts.com/highcharts.js"></script>
			<script src="https://code.highcharts.com/modules/exporting.js"></script>
		</ui:fragment>	
		
		<h:form id="idFormContratoView">
		<div class="row">
			<br />
		</div>
		<div class="row">

			<div class="col-md-12">
				<h1 class="profile-username text-center">
					#{contratoViewController.contratoTO.contrato.cliente.nome} - #{contratoViewController.contratoTO.contrato.identificador}
					<br />
					<span class="btn #{contratoViewController.contratoTO.contrato.status.name eq 'ATIVO'?'btn-success':'btn-danger'}" style="cursor:auto;">
						<h:outputText value="#{contratoViewController.contratoTO.contrato.status}" />  
					</span>
				</h1>
				<ui:fragment rendered="#{contratoViewController.contratoTO.contrato.dataParaBloqueio ne null}">
					<h4 class="alert alert-danger text-center">#{resources['label.global.contratobloqueadonovamente']} 
						<h:outputText value="#{contratoViewController.contratoTO.contrato.dataParaBloqueio}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
						</h:outputText>
					</h4>
				</ui:fragment>	
			</div>
			<div class="col-md-12">
				<div class="nav-tabs-custom">
					<ul class="nav nav-tabs">
						<li class="#{contratoViewController.contratoTO.abaAtiva eq 'dadosgerais'?'active':''}">
							<h:commandLink>
								<f:ajax event="click" immediate="true"/>
								<f:passThroughAttribute name="href" value="#dadosgerais" />
								<f:passThroughAttribute name="data-toggle" value="tab" />
								<f:setPropertyActionListener value="dadosgerais" target="#{contratoViewController.contratoTO.abaAtiva}" />
								#{resources['label.global.dadosgerais']}
							</h:commandLink>
						</li>
						<li class="#{contratoViewController.contratoTO.abaAtiva eq 'financeiro'?'active':''}">
							<h:commandLink>
								<f:ajax /> 
								<f:passThroughAttribute name="href" value="#financeiro" />
								<f:passThroughAttribute name="data-toggle" value="tab" />
								<f:setPropertyActionListener value="financeiro" target="#{contratoViewController.contratoTO.abaAtiva}" />
								#{resources['label.global.financeiro']}
							</h:commandLink>
						</li>
						
						<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.notificacoes}">
							<li class="#{contratoViewController.contratoTO.abaAtiva eq 'notificacoes'?'active':''}">
								<h:commandLink value="#{resources['label.global.notificacoes']}">
									<f:ajax event="click" />
									<f:passThroughAttribute name="href" value="#notificacoes" />
									<f:passThroughAttribute name="data-toggle" value="tab" />
									<f:setPropertyActionListener value="notificacoes" target="#{contratoViewController.contratoTO.abaAtiva}" />
								</h:commandLink>
							</li>
						</ui:fragment>	
					</ul>
					<div class="tab-content">
						<div class="#{contratoViewController.contratoTO.abaAtiva eq 'dadosgerais'?'active':''} tab-pane" id="dadosgerais">
							<div class="card card-accent-info">
								<div class="card-header">
									<i class="fa fa-user" />
									<strong>#{resources['label.global.informacoes']}</strong>
									<ui:fragment rendered="#{securityBean.isPermissao('ADMIN') or securityBean.isPermissao('SUPER_ADMIN')}">
										<a href="#{request.contextPath}/contrato/editar/#{contratoViewController.contratoTO.contrato.id}"><span class="badge badge-success float-right">#{resources['label.global.editar']}</span></a>
									</ui:fragment>	
								</div>
								<div class="card-block">
									<div class="row">
										<div class="col-sm-2">
											<div class="form-group">
												<label>#{resources['label.global.tipopessoa']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa}
											</div>
										</div>
										<h:panelGroup id="idTipoPessoa" styleClass="col-sm-2"> 
											<ui:fragment
												rendered="#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa.name eq 'FISICA'}">
												<div>
													<div class="form-group">
														<label>#{resources['label.global.cpf']}:</label><br /> #{contratoViewController.contratoTO.contrato.cliente.cpfCnpj}
													</div>
												</div>
											</ui:fragment>
											<ui:fragment
												rendered="#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa.name eq 'JURIDICA'}">
												<div>
													<div class="form-group">
														<label>#{resources['label.global.cnpj']}:</label><br /> 
														#{contratoViewController.contratoTO.contrato.cliente.cpfCnpj}
													</div>
												</div>
											</ui:fragment>
										</h:panelGroup>
										<div class="col-sm-2">
											<div class="form-group">
												<label for="formContrato:contrato_diamesvencimento">#{resources['label.global.diamesvencimento']}:</label><br />
												#{contratoViewController.contratoTO.contrato.diaMesVencimento}
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-sm-6">
											<div class="form-group">
												<label for="formContrato:contrato_nome">#{resources['label.global.nome']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.nome}
											</div>
										</div>
										<div class="col-sm-4">
											<div class="form-group">
												<label for="formContrato:contrato_email">#{resources['label.global.email']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.email}
											</div>
										</div>
										<div class="col-sm-4">
											<div class="form-group">
												<label for="formContrato:contrato_email">#{resources['label.global.endereco']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.endereco}
											</div>
										</div>
										<div class="col-sm-2">
											<div class="form-group">
												<label for="formContrato:contrato_email">#{resources['label.global.numero']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.numeroEndereco}
											</div>
										</div>
										<div class="col-sm-2">
											<div class="form-group">
												<label for="formContrato:contrato_email">#{resources['label.global.cidade']} / #{resources['label.global.uf']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.cidade.nome} / #{contratoViewController.contratoTO.contrato.cliente.uf.sigla} 
											</div>
										</div>
									</div>
								</div>
							</div>
							<ui:fragment rendered="#{contratoViewController.contratoTO.contrato.status.name() eq 'BLOQUEADO'}">
								<br />
								<div class="text-center">
									<a href="#" data-toggle="modal" data-target="#idDesbloquearContrato" class="btn btn-sm btn-info"><i class="fa fa-magic"></i> #{resources['label.global.desbloquear']} </a>
								</div>
								<br /> 
								<h:outputText value=" " />
							</ui:fragment>
							
							<div class="card card-accent-warning">
								<div class="card-header">
									<i class="fa fa-tags" />
									<strong>#{resources['label.global.produtos']}</strong>
								</div>
								<div class="card-block">
									<h:panelGroup id="idGroupProduto">
										<div class="row">
											<div class="col-sm-12">
											<table id="idDataTableContratoProduto" class="table table-bordered">
												<thead>
													<tr>
													<th class="visible-md visible-lg" scope="col">#{resources['label.global.data']}</th>
													<th scope="col">#{resources['label.global.qtd']}</th>
													<th scope="col">#{resources['label.global.nome']}</th>
													<th scope="col">#{resources['label.global.tecnologia']}</th>
													<th scope="col" class="visible-md visible-lg">#{resources['label.global.valorbase']}</th>
													<th scope="col">#{resources['label.global.unid']}</th>
													<th scope="col">#{resources['label.global.valortotal']}</th>
													<th scope="col">#{resources['label.global.datainicio']}</th>
													<th scope="col">#{resources['label.global.datafim']}</th>
													</tr>
												</thead>
											<ui:repeat var="contratoProduto" value="#{contratoViewController.contratoTO.contrato.contratoProdutos}">
												<tr class="#{contratoProduto.vigente?'card-success-clean':''}">
													<td class="visible-md visible-lg">
														<h:outputText value="#{contratoProduto.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</td>
													<td>
														<h:outputText value="#{contratoProduto.qtd}x" />
													</td>
													<td>
														<h:outputText value="#{contratoProduto.produto.nome}" />
													</td>
													
													<td>
														<h:outputText value="#{contratoProduto.tecnologia.descricao}" />
													</td>
													<td class="visible-md visible-lg">
														<h:outputText value="#{contratoProduto.produto.valor}">
															<f:convertNumber pattern="#,##0.00" /> 
														</h:outputText>
													</td>
													<td>
														<h:outputText value="#{contratoProduto.valor}">
															<f:convertNumber pattern="#,##0.00" /> 
														</h:outputText>
													
													</td>
													<td>
														<h:outputText value="#{contratoProduto.valorTotal}">
															<f:convertNumber pattern="#,##0.00" /> 
														</h:outputText>
													</td>
													<td>
														<h:outputText value="#{contratoProduto.dataInicio}">
															<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
														</h:outputText>
													</td>
													<td>
														<h:outputText value="#{contratoProduto.dataFim}">
															<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
														</h:outputText>
													</td>
												</tr>
											</ui:repeat>
											</table>
											</div>
										</div>
									</h:panelGroup>
								</div>
							</div>

							<div class="card card-accent-success">
								<div class="card-header">
									<i class="fa fa-sliders" />
									<strong>#{resources['label.global.grupos']}</strong>
								</div>

								<div class="card-block">

									<h:panelGroup id="idGroupGrupo">

										<div class="row">
											<div class="col-sm-12">
												<h:dataTable id="idDataTableContratoGrupo"
													rendered="#{contratoViewController.contratoTO.contrato.contratoGrupos ne null and  not empty contratoViewController.contratoTO.contrato.contratoGrupos}"
													value="#{contratoViewController.contratoTO.contrato.contratoGrupos}"
													var="contratoGrupo" styleClass="table table-bordered table-striped">

													<h:column>
														<f:facet name="header">#{resources['label.global.data']}</f:facet>
														<h:outputText value="#{contratoGrupo.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"  />
														</h:outputText>
													</h:column>

													<h:column>
														<f:facet name="header">#{resources['label.global.nome']}</f:facet>
														<h:outputText value="#{contratoGrupo.grupo.nome}" />
													</h:column>

												</h:dataTable>
											</div>
										</div>
									</h:panelGroup>

								</div>
							</div>

							<div class="card card-accent-danger">
								<div class="card-header">
									<i class="fa fa-cogs" />
									<strong>#{resources['label.global.equipamentos']}</strong>
								</div>

								<div class="card-block">

									<h:panelGroup id="idGroupEquipamento">

										<div class="row">
											<div class="col-sm-12">
												<h:dataTable id="idDataTableContratoEquipamento"
													rendered="#{contratoViewController.contratoTO.contrato.contratoEquipamentos ne null and  not empty contratoViewController.contratoTO.contrato.contratoEquipamentos}"
													value="#{contratoViewController.contratoTO.contrato.contratoEquipamentos}"
													var="contratoEquipamento" styleClass="table table-bordered table-striped">

													<h:column>
														<f:facet name="header">#{resources['label.global.data']}</f:facet>
														<h:outputText value="#{contratoEquipamento.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy"  timeZone="America/Sao_Paulo" />
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.nome']}</f:facet>
														<h:outputText
															value="#{contratoEquipamento.equipamento.nome}" />
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.datainstalacao']}</f:facet>
														<h:outputText value="#{contratoEquipamento.dataInstalacao}">
															<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.dataretirada']}</f:facet>
														<h:outputText value="#{contratoEquipamento.dataRetirada}">
															<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.numeroserie']}</f:facet>
														<h:outputText value="#{contratoEquipamento.numeroSerie}" />
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.comodato']}</f:facet>
														<h:commandLink>
															#{resources['label.global.gerarcomodato']}
													        <f:setPropertyActionListener target="#{contratoViewController.contratoTO.contratoEquipamento}" value="#{contratoEquipamento}" />
													        <f:ajax />
													       	<f:passThroughAttribute name="data-toggle" value="modal" />
															<f:passThroughAttribute name="data-target" value="#idGerarComodato" />
													    </h:commandLink>
													</h:column>
													<h:column>
													<f:facet name="header">#{resources['label.global.retirada']}</f:facet>
														<h:commandLink>
															#{resources['label.global.gerarretirada']}
													        <f:setPropertyActionListener target="#{contratoViewController.contratoTO.contratoEquipamento}" value="#{contratoEquipamento}" />
													        <f:ajax />
													       	<f:passThroughAttribute name="data-toggle" value="modal" />
															<f:passThroughAttribute name="data-target" value="#idGerarRetirada" />
													    </h:commandLink>
													</h:column>
												</h:dataTable>
											</div>
										</div>
									</h:panelGroup>
								</div>
							</div>
							<div class="card card-accent-success">
						<div class="card-header">
							<strong>#{resources['label.global.autenticacao']}</strong>
						</div>

						<div class="card-block">
								<div class="row">
									<div class="col-sm-12">
										<h:dataTable id="idDataTableContratoAutenticacao"
											rendered="#{contratoViewController.contratoTO.contrato.autenticacoes ne null and  not empty contratoViewController.contratoTO.contrato.autenticacoes}"
											value="#{contratoViewController.contratoTO.contrato.autenticacoes}"
											var="autenticacao" styleClass="table">

											<h:column>
												<f:facet name="header">#{resources['label.global.data']}</f:facet>
												<h:outputText value="#{autenticacao.dataCriacao}">
													<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
												</h:outputText>
											</h:column>

											<h:column>
												<f:facet name="header">#{resources['label.global.username']}</f:facet>
												<h:outputText value="#{autenticacao.username}" />
											</h:column>
											
											<h:column>
												<f:facet name="header">#{resources['label.global.senha']}</f:facet>
												<h:outputText value="#{autenticacao.senha}" />
											</h:column>
											
											<h:column>
												<f:facet name="header">#{resources['label.global.grupo']}</f:facet>
												<h:outputText value="#{autenticacao.grupo}" />
											</h:column>
											
											<h:column>
												<f:facet name="header">#{resources['label.global.ip']}</f:facet>
												<h:outputText value="#{autenticacao.ip}" />
											</h:column>
											
										</h:dataTable>
									</div>
								</div>
						</div>
					</div>

					
					<ui:fragment rendered="#{contratoViewController.contratoTO.exibeSnmp and not empty contratoViewController.contratoTO.contrato.autenticacoes}">
						<ui:repeat var="autenticacao" value="#{contratoViewController.contratoTO.contrato.autenticacoes}">
							<itm:snmp username="#{autenticacao.username}" />
						</ui:repeat>	
					</ui:fragment>
					<ui:fragment rendered="#{!contratoViewController.contratoTO.exibeSnmp and not empty contratoViewController.contratoTO.contrato.autenticacoes}">
							<div class="card card-accent-success">
								<div class="row">
									<div class="col-sm-12">
										<div class="card-block">
											<div class="row">
												<div class="col-sm-12 text-center">
													<h:commandButton value="#{resources['label.global.exibirmedidordetrafego']}" styleClass="btn btn-success btn-lg text-center">
														<f:setPropertyActionListener value="true" target="#{contratoViewController.contratoTO.exibeSnmp}" />
													</h:commandButton>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
					</ui:fragment>		


						</div>
						<div class="#{contratoViewController.contratoTO.abaAtiva eq 'financeiro'?'active':''} tab-pane" id="financeiro">
							
							<ui:fragment id="idTabFinanceiro">
							
								<ui:fragment rendered="#{securityBean.isPermissao('ADMIN') or securityBean.isPermissao('SUPER_ADMIN') or securityBean.isPermissao('FINANCEIRO')}">
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-plus-square-o" />
											<strong>#{resources['label.global.adicionarLancamento']}</strong>
										</div>
										<div class="card-block">
											<div class="row">
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.descricao']}:" />
												</div>
												<div class="col-md-10">
													 <h:inputText value="#{contratoViewController.contratoTO.contratoLancamento.descricao}" />
												</div>
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.valor']}:" />
												</div>
												<div class="col-md-10">
													<itm:moeda value="#{contratoViewController.contratoTO.contratoLancamento.valor}" />
												</div>
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.geraboleto']}:" />
												</div> 
												<div class="col-md-10">
													 <h:selectBooleanCheckbox value="#{contratoViewController.contratoTO.contratoLancamento.geraBoleto}" label="#{resources['label.global.geraboleto']}">
													 	<f:ajax event="click" render="idFormContratoView"  execute="idFormContratoView" />
													 </h:selectBooleanCheckbox>
												</div>
												
												<ui:fragment rendered="#{contratoViewController.contratoTO.contratoLancamento.geraBoleto}">
													<div class="col-md-2">
														<h:outputText value="#{resources['label.global.databoleto']}:" />
													</div>
													<div class="col-md-10">
														 <itm:data value="#{contratoViewController.contratoTO.contratoLancamento.dataBoleto}" label="#{resources['label.global.databoleto']}" />
													</div>
												</ui:fragment>
												
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.tipolancamento']}:" />
												</div>
												<div class="col-md-10">
													 <h:selectOneMenu value="#{contratoViewController.contratoTO.contratoLancamento.tipoLancamento}">
													    <f:selectItems  value="#{combosBean.listaTipoLancamento}" var="tipoLancamento" itemLabel="#{tipoLancamento.name}"  itemValue="#{tipoLancamento}"/>
													 </h:selectOneMenu>
												</div>
												
												<div class="col-md-2">
												</div>
												<div class="col-md-10">
													<h:commandButton action="#{contratoViewController.criarContratoLancamento}" value="#{resources['label.global.gravar']}" />
												</div>
											</div>
										</div>
									</div>		
									
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-folder-open-o" />
											<strong>#{resources['label.global.lancamentosemaberto']}</strong>
										</div>
										<div class="card-block">
		
											<div class="row">
												<div class="col-sm-12">
													<div class="form-group">
		
														<h:dataTable id="idDataTableContratoLancamento"
															rendered="#{contratoViewController.contratoTO.contrato.lancamentos ne null and  not empty contratoViewController.contratoTO.contrato.lancamentos}"
															value="#{contratoViewController.contratoTO.contrato.lancamentos}"
															var="lancamento" styleClass="table table-bordered table-striped">
															
															<h:column>
																<h:selectBooleanCheckbox value="#{lancamento.selecionado}" id="idCheckLancamento">
																	<f:ajax event="click" render="idFormContratoView:idFragmentGerarBoleto" execute="idFormContratoView:idDataTableContratoLancamento" immediate="true"/>
																</h:selectBooleanCheckbox>
															</h:column>	
															
															<h:column>
																<f:facet name="header">#{resources['label.global.data']}</f:facet>
																<h:outputText value="#{lancamento.dataLancamento}">
																	<f:convertDateTime pattern="dd/MM/yyyy" />
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.tipolancamento']}</f:facet>
																<h:outputText value="#{lancamento.tipoLancamento.name}" />
															</h:column>
															<h:column>
																<f:passThroughAttribute name="class" value="visible-md visible-lg" />
																<f:facet name="header">#{resources['label.global.descricao']}</f:facet>
																<h:outputText value="#{lancamento.descricao}" />
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.valor']}</f:facet>
																<h:outputText value="#{lancamento.valor}">
																	<f:convertNumber pattern="#,##0.00" /> 
																</h:outputText>
															</h:column>
															
															<h:column>
																<f:facet name="header">#{resources['label.global.acoes']}</f:facet>
																<h:commandLink value="#{resources['label.global.excluir']}">
																	<f:ajax listener="#{contratoViewController.excluirContratoLancamento(lancamento)}" event="click" render="idFormContratoView" immediate="true" execute="@this" />
																</h:commandLink>
																
															</h:column>
															
															
														</h:dataTable>
														
													</div>
												</div>
												<div class="row">
													<h:panelGroup id="idFragmentGerarBoleto">
														<div class="col-sm-12">
															<label ></label>
															<h:outputText value="#{resources['label.global.datavencimento']}" />
															
															<h:inputText value="#{contratoViewController.contratoTO.dataVencimentoBoleto}" 
																onkeypress="mascara(this,data);" styleClass="#{cc.attrs.styleClass}" maxlength="10" disabled="#{not contratoViewController.exibeBotaoGerarBoleto}">
																<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
																<f:ajax event="blur" />
															</h:inputText> 
															
															<br />
															<br />
															<h:commandButton id="idBotaoGerarBoleto" value="#{resources['label.global.gerarboletoselecionados']}" immediate="true" disabled="#{not contratoViewController.exibeBotaoGerarBoleto}"> 
																<f:ajax listener="#{contratoViewController.gerarBoletoListaContratoLancamento()}" event="click" execute="idFragmentGerarBoleto" render="idFormContratoView" />
															</h:commandButton>
														</div>
													</h:panelGroup>
												</div>
											</div>
										</div>
									</div>
									</ui:fragment>	
		
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-money" />
											<strong>#{resources['label.global.boletos']}</strong>
										</div>
		
										<div class="card-block">
		
											<div class="row">
												<div class="col-sm-12">
													<div class="form-group">
		
														<h:dataTable id="idDataTableContratoBoleto"
															rendered="#{contratoViewController.contratoTO.contrato.boletos ne null and  not empty contratoViewController.contratoTO.contrato.boletos}"
															value="#{contratoViewController.contratoTO.contrato.boletos}" style="font-size:10px"
															var="boleto" styleClass="table table-bordered table-striped">
		
															<h:column>
																<f:passThroughAttribute name="class" value="visible-md visible-lg" />
																<f:facet name="header">#{resources['label.global.nossonumero']}</f:facet>
																<h:outputText value="#{boleto.nossoNumero}">
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.datavencimento']}</f:facet>
																<h:outputText value="#{boleto.dataVencimento}">
																	<f:convertDateTime pattern="dd/MM/yyyy" />
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.status']}</f:facet>
																<h:outputText value="#{boleto.status.name}" />
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.valor']}</f:facet>
																<h:outputText value="#{boleto.valor}">
																	<f:convertNumber pattern="#,##0.00" /> 
																</h:outputText>
															</h:column>
															<h:column>
																<f:passThroughAttribute name="class" value="visible-md visible-lg" />
																<f:facet name="header">#{resources['label.global.itens']}</f:facet>
																<ul>
																	<ui:repeat var="lancamento" value="#{boleto.lancamentos}">
																		<li>#{lancamento.contratoLancamento.descricao}: <h:outputText value="#{lancamento.contratoLancamento.valor}"><f:convertNumber pattern="#,##0.00" /></h:outputText></li>	
																	</ui:repeat>
																</ul>
															</h:column>
															
															<h:column>
																<f:facet name="header">#{resources['label.global.acoes']}</f:facet>
																
																<ul>
																		<ui:fragment rendered="#{boleto.dataVencimento ge contratoViewController.contratoTO.dataAtual}">
																			<li>
																			<h:commandLink  action="#{contratoViewController.downloadBoleto(boleto)}">
																				<i class="fa fa-download"></i> #{resources['label.global.download']}
																			</h:commandLink>
																			</li>
																			<ui:fragment rendered="#{securityBean.isPermissao('ADMIN') or securityBean.isPermissao('SUPER_ADMIN')}">
																				<li>
																				<h:commandLink styleClass="btn btn-danger" rendered="#{boleto.remessa eq null or boleto.remessa.id eq null}">
																					<f:ajax listener="#{contratoViewController.excluirBoleto(boleto)}" event="click" render="idFormContratoView" immediate="true" execute="@this" />
																					<i class="fa fa-times"></i> #{resources['label.global.excluir']}
																				</h:commandLink><h:outputText value=" " />
																				</li>
																			</ui:fragment>	
																			<ui:fragment rendered="#{boleto.remessa ne null and boleto.remessa.dataEnvio ne null}">
																				<li>
																					<h:commandLink  styleClass="btn btn-sm btn-success" action="#{contratoViewController.enviarEmail(boleto)}">
																						<i class="fa fa-envelope-o"></i> #{resources['label.global.enviaremail']} 
																					</h:commandLink>
																				</li>
																			</ui:fragment>
																			<ui:fragment rendered="#{boleto.remessa ne null and boleto.remessa.dataEnvio ne null}">
																				<li>
																					<h:commandLink  action="#{contratoViewController.enviarSMS(boleto)}">
																						<i class="fa fa-commenting-o"></i> #{resources['label.global.enviarsms']} 
																					</h:commandLink>
																				</li>
																			</ui:fragment>	
																			<ui:fragment rendered="#{securityBean.isPermissao('ADMIN') or securityBean.isPermissao('SUPER_ADMIN')}">
																				<ui:fragment rendered="#{boleto.remessa ne null and boleto.remessa.id ne null}">
																					<li>	
																						<h:commandLink  styleClass="btn btn-sm btn-success" action="#{contratoViewController.removerBoletoRemessa(boleto)}" rendered="#{boleto.remessa ne null and boleto.remessa.id ne null}">
																							<i class="fa fa-times"></i> #{resources['label.global.remover']} 
																						</h:commandLink>
																					</li>	
																				</ui:fragment>	
																			</ui:fragment>	
																		</ui:fragment>	
																		<ui:fragment rendered="#{boleto.dataVencimento lt contratoViewController.contratoTO.dataAtual and boleto.status.name eq 'ABERTO'}">
																		
																			<li>																		
																			<h:commandLink>
																				#{resources['label.global.2via']}
																		        <f:setPropertyActionListener target="#{contratoViewController.contratoTO.boletoSegundaVia}" value="#{boleto}" />
																		        <f:ajax />
																		       	<f:passThroughAttribute name="data-toggle" value="modal" />
																				<f:passThroughAttribute name="data-target" value="#idSegundaVia" />
																		    </h:commandLink>
																		    </li>
																		    
																		    <ui:fragment rendered="#{securityBean.isPermissao('ADMIN') or securityBean.isPermissao('SUPER_ADMIN')}">
																		    
																		    	<ui:fragment rendered="#{boleto.remessa ne null and boleto.remessa.id ne null}">
																		    	<li>
																				    <h:commandLink  action="#{contratoViewController.removerBoletoRemessa(boleto)}" style="">
																						 #{resources['label.global.remover']} 
																					</h:commandLink>
																				</li>
																				</ui:fragment>
																				<ui:fragment rendered="#{boleto.remessa eq null or boleto.remessa.id eq null}">
																					<li>	
																						<h:commandLink>
																							<f:ajax listener="#{contratoViewController.excluirBoleto(boleto)}" event="click" render="idFormContratoView" immediate="true" execute="@this" />
																							#{resources['label.global.excluir']}
																						</h:commandLink>
																					</li>
																				</ui:fragment>	
																				<li>	
																					<h:commandLink>
																						#{resources['label.global.pagarboleto']}
																				        <f:setPropertyActionListener target="#{contratoViewController.contratoTO.boleto}" value="#{boleto}" />
																				        <f:ajax />
																				       	<f:passThroughAttribute name="data-toggle" value="modal" />
																						<f:passThroughAttribute name="data-target" value="#idPagarBoleto" />
																				    </h:commandLink>
																				 </li>   
																			 </ui:fragment>   
																		</ui:fragment>	
																	</ul>	
															</h:column>
														</h:dataTable>
													</div>
												</div>
											</div>
										</div>
									</div>
									
									
									
									
								</ui:fragment>	
						</div>
						<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.notificacoes}">
							<div class="#{contratoViewController.contratoTO.abaAtiva eq 'notificacoes'?'active':''} tab-pane" id="notificacoes">
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-money" />
											<strong>#{resources['label.global.ultimasnotificacoes']}</strong>
										</div>
		
										<div class="card-block">
												<h:dataTable value="#{contratoViewController.contratoTO.contrato.notificacoes}" var="notificacao" styleClass="table table-bordered table-striped">
													<h:column>
														<f:facet name="header">
															<h:outputText value="#{resources['label.global.data']}" />
														</f:facet>
														<h:outputText value="#{notificacao.dataEnvio}">
															<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" timeZone="America/Sao_Paulo" />
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">
															<h:outputText value="#{resources['label.global.meiodeenvio']}" />
														</f:facet>
														<h:outputText value="#{notificacao.meioEnvio.name}">
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">
															<h:outputText value="#{resources['label.global.tipo']}" />
														</f:facet>
														<h:outputText value="#{notificacao.tipo.name}">
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">
															<h:outputText value="#{resources['label.global.texto']}" />
														</f:facet>
														<h:outputText value="#{notificacao.texto}" />
													</h:column>
												</h:dataTable>
											</div>
									</div>
							</div>
						</ui:fragment>	
					</div>
				</div>
			</div>
		</div>
		
				<itm:confirm id="idDesbloquearContrato" titulo="#{resources['label.global.confirmacao']}" mensagem="#{resources['label.global.desejadesbloquearcontrato']}">
					<h:commandLink action="#{contratoViewController.desbloquearContratoTemporariamente()}" class="btn btn-md btn-info">
						<i class="fa fa-pencil-square-o" /> #{resources['label.global.desbloquear']} 
					</h:commandLink>
				</itm:confirm>
				
				
				
				<itm:modal id="idSegundaVia" titulo="#{resources['label.global.segundavia']}">
					<div class="row">
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.informeadata']}" /> 
						</div>
						<div class="col-sm-4">
							<itm:data value="#{contratoViewController.contratoTO.dataSegundaViaBoleto}">
							</itm:data>
						</div>
						
						<div class="col-sm-2">
							<h:commandLink styleClass="btn btn-secondary" action="#{contratoViewController.enviarSegundaViaBoleto}">
								<i class="fa fa-download"></i> #{resources['label.global.enviaremail']}
							</h:commandLink>
						</div>
						<div class="col-sm-2">
							<h:commandLink styleClass="btn btn-secondary" action="#{contratoViewController.gerarSegundaViaBoleto}">
								<i class="fa fa-download"></i> #{resources['label.global.download']}
							</h:commandLink>
						</div>
					</div>
				</itm:modal>
				
				
				<itm:modal id="idPagarBoleto" titulo="#{resources['label.global.pagarboleto']}">
					<div class="row">
					
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.datapagamento']}" /> 
						</div>
						<div class="col-sm-9">
							<itm:data value="#{contratoViewController.contratoTO.boleto.dataPagamento}" />
						</div>
						
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.valorpago']}" /> 
						</div>
						<div class="col-sm-9">
							<itm:moeda value="#{contratoViewController.contratoTO.boleto.valorPago}"  />
						</div>
						
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.informeachavemestra']}" /> 
						</div>
						<div class="col-sm-9">
							<h:inputText value="#{contratoViewController.contratoTO.chaveMestra}" />
						</div>
						
						<div class="col-sm-3">
							<h:outputText value=" " />
						</div>
						<div class="col-sm-9">
							<h:commandLink styleClass="btn btn-secondary" action="#{contratoViewController.pagarBoleto}">
								<i class="fa fa-download"></i> #{resources['label.global.pagarboleto']} 
							</h:commandLink>
						</div>
					</div>
				</itm:modal>
				
				
				<itm:modal id="idGerarComodato" titulo="#{resources['label.global.gerarcomodato']}">
					<div class="row">
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.protocolo']}" /> 
						</div>
						<div class="col-sm-9">
							<h:inputText value="#{contratoViewController.contratoTO.contratoEquipamento.protocoloInstalacao}" />
						</div>
						<div class="col-sm-9">
							<h:commandLink action="#{contratoViewController.gerarComodato}" class="fa fa-print" value="   #{resources['label.global.imprimir']}" title="#{resources['label.global.gerarcomodato']}" >
								 <f:ajax event="blur" onevent="function(data) { if (data.status == 'success') {fecharModal();} }" />
							 </h:commandLink>
						</div>
					</div>
				</itm:modal>
				
				
				<itm:modal id="idGerarRetirada" titulo="#{resources['label.global.gerarretirada']}">
					<div class="row">
					
						<div class="col-sm-3">
							<h:outputText value="#{resources['label.global.protocolo']}" /> 
						</div>
						<div class="col-sm-9">
							<h:inputText value="#{contratoViewController.contratoTO.contratoEquipamento.protocoloRetirada}" />
						</div>
						
						<div class="col-sm-9">
							<h:commandLink action="#{contratoViewController.gerarRetirada}" class="fa fa-print" value="   #{resources['label.global.imprimir']}" title="#{resources['label.global.gerarretirada']}">
								 <f:ajax event="blur" onevent="function(data) { if (data.status == 'success') {fecharModal();} }" />																				
							</h:commandLink>
						</div>
					</div>
				</itm:modal>
				
				
	</h:form>
	
	<div id="rate">
	
	
	</div>
	
	<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.autenticacoes}">
			
		</ui:fragment>	
		
					
	<script type="text/javascript">
		//<![CDATA[
		
			function fecharModal() {
				$('#idGerarComodato').modal('hide');
				$('#idGerarRetirada').modal('hide');
			}
		//]]>
	</script>
	</ui:define>

</ui:composition>
