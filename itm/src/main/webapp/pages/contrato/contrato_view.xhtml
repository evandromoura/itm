<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:itm="http://java.sun.com/jsf/composite/components"
	template="/WEB-INF/templates/default.xhtml">



	<ui:define name="breadcrumb">
		<li class="breadcrumb-item"><a href="#">Home</a></li>
		<li class="breadcrumb-item"><a href="#{request.contextPath}/cliente">#{resources['label.global.cliente']}</a></li>
		<li class="breadcrumb-item"><a href="#{request.contextPath}/cliente/view/#{contratoViewController.contratoTO.contrato.cliente.id}">#{contratoViewController.contratoTO.contrato.cliente.nome}</a></li>
		<li class="breadcrumb-item active">#{contratoViewController.contratoTO.contrato.identificador}</li>
	</ui:define>
	<ui:param name="menu" value="cliente" />

	<ui:define name="corpo">
		<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.autenticacoes}">
			<script src="https://code.highcharts.com/highcharts.js"></script>
			<script src="https://code.highcharts.com/modules/exporting.js"></script>
		</ui:fragment>	
		
		<h:form id="idFormContratoView">
		<div class="row">
			<br />
		</div>
		<div class="row">

			<div class="col-md-12">
				<h1 class="profile-username text-center">#{contratoViewController.contratoTO.contrato.identificador}</h1>
				<ui:fragment rendered="#{contratoViewController.contratoTO.contrato.dataParaBloqueio ne null}">
					<h4 class="alert alert-danger text-center">#{resources['label.global.contratobloqueadonovamente']} 
						<h:outputText value="#{contratoViewController.contratoTO.contrato.dataParaBloqueio}">
							<f:convertDateTime pattern="dd/MM/yyyy"/>
						</h:outputText>
					</h4>
				</ui:fragment>	
			</div>
			<div class="col-md-12">
				<div class="nav-tabs-custom">
					<ul class="nav nav-tabs">
						<li class="#{contratoViewController.contratoTO.abaAtiva eq 'dadosgerais'?'active':''}">
							<h:commandLink>
								<f:ajax event="click" immediate="true"/>
								<f:passThroughAttribute name="href" value="#dadosgerais" />
								<f:passThroughAttribute name="data-toggle" value="tab" />
								<f:setPropertyActionListener value="dadosgerais" target="#{contratoViewController.contratoTO.abaAtiva}" />
								#{resources['label.global.dadosgerais']}
							</h:commandLink>
						</li>
						<li class="#{contratoViewController.contratoTO.abaAtiva eq 'financeiro'?'active':''}">
							<h:commandLink>
								<f:ajax /> 
								<f:passThroughAttribute name="href" value="#financeiro" />
								<f:passThroughAttribute name="data-toggle" value="tab" />
								<f:setPropertyActionListener value="financeiro" target="#{contratoViewController.contratoTO.abaAtiva}" />
								#{resources['label.global.financeiro']}
							</h:commandLink>
						</li>
						
						<li class="#{contratoViewController.contratoTO.abaAtiva eq 'logs'?'active':''}">
							<h:commandLink value="#{resources['label.global.logs']}">
								<f:ajax event="click" />
								<f:passThroughAttribute name="href" value="#logs" />
								<f:passThroughAttribute name="data-toggle" value="tab" />
								<f:setPropertyActionListener value="logs" target="#{contratoViewController.contratoTO.abaAtiva}" />
							</h:commandLink>
						</li>	
					</ul>
					<div class="tab-content">
						<div class="#{contratoViewController.contratoTO.abaAtiva eq 'dadosgerais'?'active':''} tab-pane" id="dadosgerais">
							<div class="card card-accent-info">
								<div class="card-header">
									<i class="fa fa-user" />
									<strong>#{resources['label.global.informacoes']}</strong>
									<a href="#{request.contextPath}/contrato/editar/#{contratoViewController.contratoTO.contrato.id}"><span class="badge badge-success float-right">#{resources['label.global.editar']}</span></a>
								</div>
								<div class="card-block">
									<div class="row">
										<div class="col-sm-6">
											<div class="form-group">
												<label>#{resources['label.global.tipopessoa']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa}
											</div>
										</div>
										<h:panelGroup id="idTipoPessoa">
											<ui:fragment
												rendered="#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa.name eq 'FISICA'}">
												<div class="col-sm-6">
													<div class="form-group">
														<label>#{resources['label.global.cpf']}:</label>#{contratoViewController.contratoTO.contrato.cliente.cpfCnpj}
													</div>
												</div>
											</ui:fragment>
											<ui:fragment
												rendered="#{contratoViewController.contratoTO.contrato.cliente.tipoPessoa.name eq 'JURIDICA'}">
												<div class="col-sm-6">
													<div class="form-group">
														<label>#{resources['label.global.cnpj']}:</label>
														#{contratoViewController.contratoTO.contrato.cliente.cpfCnpj}
													</div>
												</div>
											</ui:fragment>
										</h:panelGroup>
									</div>
									<div class="row">
										<div class="col-sm-6">
											<div class="form-group">
												<label for="formContrato:contrato_nome">#{resources['label.global.nome']}:</label><br />
												#{contratoViewController.contratoTO.contrato.cliente.nome}
											</div>
										</div>
										<div class="col-sm-6">
											<div class="form-group">
												<label for="formContrato:contrato_diamesvencimento">#{resources['label.global.diamesvencimento']}:</label><br />
												#{contratoViewController.contratoTO.contrato.diaMesVencimento}
											</div>
										</div>
									</div>
								</div>
							</div>
							<ui:fragment rendered="#{contratoViewController.contratoTO.contrato.status.name() eq 'BLOQUEADO'}">
								<br />
								<a href="#" data-toggle="modal" data-target="#idDesbloquearContrato" class="btn btn-info">#{resources['label.global.desbloquear']} </a>
								<br /> 
								<h:outputText value=" " />
							</ui:fragment>
							
							<div class="card card-accent-warning">
								<div class="card-header">
									<i class="fa fa-tags" />
									<strong>#{resources['label.global.produtos']}</strong>
								</div>

								<div class="card-block">

									<h:panelGroup id="idGroupProduto">

										<div class="row">
											<div class="col-sm-12">
												<h:dataTable id="idDataTableContratoProduto"
													rendered="#{contratoViewController.contratoTO.contrato.contratoProdutos ne null and  not empty contratoViewController.contratoTO.contrato.contratoProdutos}"
													value="#{contratoViewController.contratoTO.contrato.contratoProdutos}"
													var="contratoProduto" styleClass="table table-bordered table-striped" >

													<h:column>
														<f:facet name="header">#{resources['label.global.data']}</f:facet>
														<h:outputText value="#{contratoProduto.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</h:column>


													<h:column>
														<f:facet name="header">#{resources['label.global.nome']}</f:facet>
														<h:outputText value="#{contratoProduto.produto.nome}" />
													</h:column>


													<h:column>
														<f:facet name="header">#{resources['label.global.valorbase']}</f:facet>
														<h:outputText value="#{contratoProduto.produto.valor}">
															<f:convertNumber pattern="#,##0.00" /> 
														</h:outputText>
													</h:column>

													<h:column>
														<f:facet name="header">#{resources['label.global.valortotal']}</f:facet>
														<h:outputText value="#{contratoProduto.valor}">
															<f:convertNumber pattern="#,##0.00" /> 
														</h:outputText>
													</h:column>

													<h:column>
														<f:facet name="header">#{resources['label.global.datainicio']}</f:facet>
														<h:outputText value="#{contratoProduto.dataInicio}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</h:column>

													<h:column>
														<f:facet name="header">#{resources['label.global.datafim']}</f:facet>
														<h:outputText value="#{contratoProduto.dataFim}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</h:column>

												</h:dataTable>
											</div>
										</div>
									</h:panelGroup>

								</div>
							</div>


							<div class="card card-accent-success">
								<div class="card-header">
									<i class="fa fa-sliders" />
									<strong>#{resources['label.global.grupos']}</strong>
								</div>

								<div class="card-block">

									<h:panelGroup id="idGroupGrupo">

										<div class="row">
											<div class="col-sm-12">
												<h:dataTable id="idDataTableContratoGrupo"
													rendered="#{contratoViewController.contratoTO.contrato.contratoGrupos ne null and  not empty contratoViewController.contratoTO.contrato.contratoGrupos}"
													value="#{contratoViewController.contratoTO.contrato.contratoGrupos}"
													var="contratoGrupo" styleClass="table table-bordered table-striped">

													<h:column>
														<f:facet name="header">#{resources['label.global.data']}</f:facet>
														<h:outputText value="#{contratoGrupo.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</h:column>

													<h:column>
														<f:facet name="header">#{resources['label.global.nome']}</f:facet>
														<h:outputText value="#{contratoGrupo.grupo.nome}" />
													</h:column>

												</h:dataTable>
											</div>
										</div>
									</h:panelGroup>

								</div>
							</div>

							<div class="card card-accent-danger">
								<div class="card-header">
									<i class="fa fa-cogs" />
									<strong>#{resources['label.global.equipamentos']}</strong>
								</div>

								<div class="card-block">

									<h:panelGroup id="idGroupEquipamento">

										<div class="row">
											<div class="col-sm-12">
												<h:dataTable id="idDataTableContratoEquipamento"
													rendered="#{contratoViewController.contratoTO.contrato.contratoEquipamentos ne null and  not empty contratoViewController.contratoTO.contrato.contratoEquipamentos}"
													value="#{contratoViewController.contratoTO.contrato.contratoEquipamentos}"
													var="contratoEquipamento" styleClass="table table-bordered table-striped">

													<h:column>
														<f:facet name="header">#{resources['label.global.data']}</f:facet>
														<h:outputText value="#{contratoEquipamento.dataCriacao}">
															<f:convertDateTime pattern="dd/MM/yyyy" />
														</h:outputText>
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.nome']}</f:facet>
														<h:outputText
															value="#{contratoEquipamento.equipamento.nome}" />
													</h:column>
													<h:column>
														<f:facet name="header">#{resources['label.global.numeroserie']}</f:facet>
														<h:outputText value="#{contratoEquipamento.numeroSerie}" />
													</h:column>

												</h:dataTable>
											</div>
										</div>
									</h:panelGroup>

								</div>
								
							</div>
							<div class="card card-accent-success">
						<div class="card-header">
							<strong>#{resources['label.global.autenticacao']}</strong>
						</div>

						<div class="card-block">
								<div class="row">
									<div class="col-sm-12">
										<h:dataTable id="idDataTableContratoAutenticacao"
											rendered="#{contratoViewController.contratoTO.contrato.autenticacoes ne null and  not empty contratoViewController.contratoTO.contrato.autenticacoes}"
											value="#{contratoViewController.contratoTO.contrato.autenticacoes}"
											var="autenticacao" styleClass="table">

											<h:column>
												<f:facet name="header">#{resources['label.global.data']}</f:facet>
												<h:outputText value="#{autenticacao.dataCriacao}">
													<f:convertDateTime pattern="dd/MM/yyyy" />
												</h:outputText>
											</h:column>

											<h:column>
												<f:facet name="header">#{resources['label.global.username']}</f:facet>
												<h:outputText value="#{autenticacao.username}" />
											</h:column>
											
											<h:column>
												<f:facet name="header">#{resources['label.global.senha']}</f:facet>
												<h:outputText value="#{autenticacao.senha}" />
											</h:column>
											
											<h:column>
												<f:facet name="header">#{resources['label.global.ip']}</f:facet>
												<h:outputText value="#{autenticacao.ip}" />
											</h:column>
											
										</h:dataTable>
									</div>
								</div>
						</div>
					</div>


					<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.autenticacoes}">
							<div class="card card-accent-success">
								<div class="row">
									<div class="col-sm-6">
										<div class="card-header">
											<strong>#{resources['label.global.download']}</strong>
										</div>
										
				
										<div class="card-block">
												<div class="row">
													<div class="col-sm-12">
														<div id="container_download" style="min-width: 100%; height: 400px; margin: 0 auto"></div>
													</div>
												</div>
										</div>
									</div>	
									<div class="col-sm-6">
									
										<div class="card-header">
											<strong>#{resources['label.global.upload']}</strong>
										</div>
										<div class="card-block">
												<div class="row">
													<div class="col-sm-12">
														<div id="container_upload" style="min-width: 100%; height: 400px; margin: 0 auto"></div>
													</div>
												</div>
										</div>
									</div>
								</div>		
							</div>
					</ui:fragment>		






						</div>
						<!-- /.tab-pane -->
						<div class="#{contratoViewController.contratoTO.abaAtiva eq 'financeiro'?'active':''} tab-pane" id="financeiro">
							
							<ui:fragment id="idTabFinanceiro">
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-plus-square-o" />
											<strong>#{resources['label.global.adicionarLancamento']}</strong>
										</div>
										<div class="card-block">
											<div class="row">
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.descricao']}:" />
												</div>
												<div class="col-md-10">
													 <h:inputText value="#{contratoViewController.contratoTO.contratoLancamento.descricao}" />
												</div>
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.valor']}:" />
												</div>
												<div class="col-md-10">
													<itm:moeda value="#{contratoViewController.contratoTO.contratoLancamento.valor}" />
												</div>
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.geraboleto']}:" />
												</div> 
												<div class="col-md-10">
													 <h:selectBooleanCheckbox value="#{contratoViewController.contratoTO.contratoLancamento.geraBoleto}" label="#{resources['label.global.geraboleto']}" />
												</div>
												
												<div class="col-md-2">
													<h:outputText value="#{resources['label.global.tipolancamento']}:" />
												</div>
												<div class="col-md-10">
													 <h:selectOneMenu value="#{contratoViewController.contratoTO.contratoLancamento.tipoLancamento}">
													    <f:selectItems  value="#{combosBean.listaTipoLancamento}" var="tipoLancamento" itemLabel="#{tipoLancamento.name}"  itemValue="#{tipoLancamento}"/>
													 </h:selectOneMenu>
												</div>
												
												<div class="col-md-2">
												</div>
												<div class="col-md-10">
													<h:commandButton action="#{contratoViewController.criarContratoLancamento}" value="#{resources['label.global.gravar']}" />
												</div>
											</div>
										</div>
									</div>		
									
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-folder-open-o" />
											<strong>#{resources['label.global.lancamentosemaberto']}</strong>
										</div>
										<div class="card-block">
		
											<div class="row">
												<div class="col-sm-12">
													<div class="form-group">
		
														<h:dataTable id="idDataTableContratoLancamento"
															rendered="#{contratoViewController.contratoTO.contrato.lancamentos ne null and  not empty contratoViewController.contratoTO.contrato.lancamentos}"
															value="#{contratoViewController.contratoTO.contrato.lancamentos}"
															var="lancamento" styleClass="table table-bordered table-striped">
															
															<h:column>
																<f:facet name="header">#{resources['label.global.selecionar']}</f:facet>
																<h:selectBooleanCheckbox value="#{lancamento.selecionado}" id="idCheckLancamento">
																	<f:ajax event="click" render="idFormContratoView:idFragmentGerarBoleto" execute="idFormContratoView:idDataTableContratoLancamento" immediate="true"/>
																</h:selectBooleanCheckbox>
															</h:column>	
															
															<h:column>
																<f:facet name="header">#{resources['label.global.data']}</f:facet>
																<h:outputText value="#{lancamento.dataLancamento}">
																	<f:convertDateTime pattern="dd/MM/yyyy" />
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.tipolancamento']}</f:facet>
																<h:outputText value="#{lancamento.tipoLancamento.name}" />
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.descricao']}</f:facet>
																<h:outputText value="#{lancamento.descricao}" />
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.valor']}</f:facet>
																<h:outputText value="#{lancamento.valor}">
																	<f:convertNumber pattern="#,##0.00" /> 
																</h:outputText>
															</h:column>
															
															<h:column>
																<f:facet name="header">#{resources['label.global.acoes']}</f:facet>
																<h:commandLink value="#{resources['label.global.excluir']}">
																	<f:ajax listener="#{contratoViewController.excluirContratoLancamento(lancamento)}" event="click" render="idFormContratoView" immediate="true" execute="@this" />
																</h:commandLink>
																
															</h:column>
															
															
														</h:dataTable>
														
													</div>
												</div>
												<div class="row">
													<h:panelGroup id="idFragmentGerarBoleto">
														<div class="col-sm-12">
															<label ></label>
															<h:outputText value="#{resources['label.global.datavencimento']}" />
															
															<h:inputText value="#{contratoViewController.contratoTO.dataVencimentoBoleto}" 
																onkeypress="mascara(this,data);" styleClass="#{cc.attrs.styleClass}" maxlength="10" disabled="#{not contratoViewController.exibeBotaoGerarBoleto}">
																<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
																<f:ajax event="blur" />
															</h:inputText> 
															
															<br />
															<br />
															<h:commandButton id="idBotaoGerarBoleto" value="#{resources['label.global.gerarboletoselecionados']}" immediate="true" disabled="#{not contratoViewController.exibeBotaoGerarBoleto}"> 
																<f:ajax listener="#{contratoViewController.gerarBoletoListaContratoLancamento()}" event="click" execute="idFragmentGerarBoleto" render="idFormContratoView" />
															</h:commandButton>
														</div>
													</h:panelGroup>
												</div>
											</div>
										</div>
									</div>
									
									
		
									<div class="card card-accent-info">
										<div class="card-header">
											<i class="fa fa-money" />
											<strong>#{resources['label.global.boletos']}</strong>
										</div>
		
										<div class="card-block">
		
											<div class="row">
												<div class="col-sm-12">
													<div class="form-group">
		
														<h:dataTable id="idDataTableContratoBoleto"
															rendered="#{contratoViewController.contratoTO.contrato.boletos ne null and  not empty contratoViewController.contratoTO.contrato.boletos}"
															value="#{contratoViewController.contratoTO.contrato.boletos}"
															var="boleto" styleClass="table table-bordered table-striped">
		
															<h:column>
																<f:facet name="header">#{resources['label.global.datavencimento']}</f:facet>
																<h:outputText value="#{boleto.dataVencimento}">
																	<f:convertDateTime pattern="dd/MM/yyyy" />
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.status']}</f:facet>
																<h:outputText value="#{boleto.status.name}" />
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.valor']}</f:facet>
																<h:outputText value="#{boleto.valor}">
																	<f:convertNumber pattern="#,##0.00" /> 
																</h:outputText>
															</h:column>
															<h:column>
																<f:facet name="header">#{resources['label.global.itens']}</f:facet>
																<ul>
																	<ui:repeat var="lancamento" value="#{boleto.lancamentos}">
																		<li>#{lancamento.contratoLancamento.descricao}: <h:outputText value="#{lancamento.contratoLancamento.valor}"><f:convertNumber pattern="#,##0.00" /></h:outputText></li>	
																	</ui:repeat>
																</ul>
															</h:column>
															
															<h:column>
																<f:facet name="header">#{resources['label.global.acoes']}</f:facet>
																<h:commandLink 
																	action="#{contratoViewController.downloadBoleto(boleto)}"
																	value="Download" /> | 
																	<h:commandLink value="#{resources['label.global.excluir']}" rendered="#{boleto.remessa eq null or boleto.remessa.id eq null}">
																		<f:ajax listener="#{contratoViewController.excluirBoleto(boleto)}" event="click" render="idFormContratoView" immediate="true" execute="@this" />
																	</h:commandLink>
																	|<h:commandLink 
																	action="#{contratoViewController.enviarEmail(boleto)}"
																	value="Enviar Email" />
																	
																	|<h:commandLink 
																	action="#{contratoViewController.enviarSMS(boleto)}"
																	value="Enviar SMS" />
																
																
															</h:column>
														</h:dataTable>
													</div>
												</div>
											</div>
										</div>
									</div>
									
									
									
									
								</ui:fragment>	
						</div>
						<div class="#{contratoViewController.contratoTO.abaAtiva eq 'logs'?'active':''} tab-pane" id="logs">
						
							<ui:fragment id="idTabLogs">
									
							</ui:fragment>
						
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<itm:confirm id="idDesbloquearContrato" titulo="#{resources['label.global.confirmacao']}" mensagem="#{resources['label.global.desejadesbloquearcontrato']}">
					<h:commandLink action="#{contratoViewController.desbloquearContratoTemporariamente()}" class="btn btn-md btn-info">
						<i class="fa fa-pencil-square-o" /> #{resources['label.global.desbloquear']} 
					</h:commandLink>
				</itm:confirm>
				
				
	</h:form>
	
	<div id="rate">
	
	
	</div>
	
	<ui:fragment rendered="#{not empty contratoViewController.contratoTO.contrato.autenticacoes}">
			<script>
		//<![CDATA[





			  $(document).ready(function () {

				    var wsocket; 
				    var downloadAnterior=0;
		            var uploadAnterior=0;
				  
				    Highcharts.setOptions({
				        global: {
				            useUTC: false
				        },
				        colors: [
				           'rgba( 0,   154, 253, 0.9 )', //bright blue
				            'rgba( 253, 99,  0,   0.9 )', //bright orange
				            'rgba( 40,  40,  56,  0.9 )', //dark
				            'rgba( 253, 0,   154, 0.9 )', //bright pink
				            'rgba( 154, 253, 0,   0.9 )', //bright green
				            'rgba( 145, 44,  138, 0.9 )', //mid purple
				            'rgba( 45,  47,  238, 0.9 )', //mid blue
				            'rgba( 177, 69,  0,   0.9 )', //dark orange
				            'rgba( 140, 140, 156, 0.9 )', //mid
				            'rgba( 238, 46,  47,  0.9 )', //mid red
				            'rgba( 44,  145, 51,  0.9 )', //mid green
				            'rgba( 103, 16,  192, 0.9 )' //dark purple
				          ],
				          chart: {
				              alignTicks: false,
				              type: '',
				              margin: [60, 25, 100, 90],
				              
				             // borderRadius:10,
				             // borderWidth:1,
				            //  borderColor:'rgba(156,156,156,.25)',
				            //  backgroundColor:'rgba(204,204,204,.25)',
				              plotBackgroundColor:'rgba(255,255,255,1)',
				              
				            }
				    });

				   var charDownload =  Highcharts.chart('container_download', {
				        chart: {
				            type: 'column',
				            marginRight: 20,
				            events: {
				                load: function () {
			
				                    
				                }
				            }
				        },
				        title: {
				            text: 'Download'
				        },
				        xAxis: {
				            type: 'datetime',
				            tickPixelInterval: 2
				        },
				        yAxis: {
				            title: {
				                text: 'Mb/s'
				            },
				            plotLines: [{
				                value: 0,
				                width: 1,
				                color: '#808080' 
				            }]
				        },
				        tooltip: {
				            formatter: function () {
				                return '<b>' + this.series.name + '</b><br/>' +
				                    Highcharts.dateFormat('%H:%M:%S', this.x) + '<br/>' +
				                    Highcharts.numberFormat(this.y, 3);
				            }
				        },
				        legend: {
				            enabled: true
				        },
				        plotOptions: {
				        	series: {
				                pointPadding: 0,
				                groupPadding: 0,
				                borderWidth: 0.5,
				                borderColor: 'rgba(255,255,255,0.5)',
				                color: Highcharts.getOptions().colors[1]
				              }
				        },
				        exporting: {
				            enabled: false
				        },
				        series: [{
				            name: 'Download',
				            lineWidth: 4,
				            data: (function () {
				                var data = [],
				                    time = (new Date()).getTime(),
				                    i;
			
				                for (i = -20; i <= 0; i += 1) {
				                    data.push({
				                        x: time + i * 1000,
				                        y: 0
				                    });
				                }
			
				                return data;
				            }())
				        }]
				    });


					
				    var charUpload = Highcharts.chart('container_upload', {
				        chart: {
				            type: 'column',
				            marginRight: 20,
				            events: {
				                load: function () {
				                    
				                }
				            }
				        },
				        title: {
				            text: 'Upload'
				        },
				        xAxis: {
				            type: 'datetime',
				            tickPixelInterval: 2
				        },
				        yAxis: {
				            title: {
				                text: 'Mb/s'
				            },
				            plotLines: [{
				                value: 0,
				                width: 1,
				                color: '#808080'
				            }]
				        },
				        tooltip: {
				            formatter: function () {
				                return '<b>' + this.series.name + '</b><br/>' + Highcharts.dateFormat('%H:%M:%S', this.x) + '<br/>' +
				                    Highcharts.numberFormat(this.y,4);
				            }
				        },
				        legend: {
				            enabled: true
				        },
				        plotOptions: {
				        	series: {
				                pointPadding: 0,
				                groupPadding: 0,
				                borderWidth: 0.5,
				                borderColor: 'rgba(255,255,255,0.5)',
				                color: Highcharts.getOptions().colors[7]
				              }
				        },
				        exporting: {
				            enabled: false
				        },
				        series: [{
				            name: 'Upload',
				            lineWidth: 4,
				            data: (function () {
				                // generate an array of random data
				                var data = [],
				                    time = (new Date()).getTime(),
				                    i;
			
				                for (i = -20; i <= 0; i += 1) {
				                    data.push({
				                        x: time + i * 1000,
				                        y: 0
				                    });
				                }
			
				                return data;
				            }())
				        }]
				    });


					  function connect() {         
/* 						wsocket = new WebSocket("ws://177.190.160.251:8080/itm/snmpserver");        */
						wsocket = new WebSocket("ws://${request.requestURL.substring(6,request.requestURL.indexOf('/pages') )}/snmpclienteserver");       
						wsocket.onmessage = onMessage;  
						wsocket.onopen = onOpen;  
					  }
					
				      function onMessage(evt) {  
					     obj = JSON.parse(evt.data);
					     console.log(obj);
						 x = (new Date()).getTime();
						 if(downloadAnterior > 0){ 
								yDownload = (((obj.download - downloadAnterior)* 8/1024)/1024);
								yDownload = yDownload < 0 ? yDownload * (-1):yDownload;
			             }else{
								yDownload =0;
				         }
				         console.log("Valor do Download " +yDownload);
				         downloadAnterior = obj.download;

						 if(uploadAnterior > 0){ 
								yUpload = (((obj.upload - uploadAnterior)* 8/1024)/1024);
								yUpload = yUpload < 0 ? yUpload * (-1):yUpload;
			             }else{
								yUpload =0;
				         }
						 uploadAnterior = obj.upload;

						 //if(yDownload > 0.1){
							 charDownload.series[0].addPoint([x, yDownload], true, true);
						 //}
						 //if(yUpload > 0.1){
							 charUpload.series[0].addPoint([x, yUpload], true, true);
						 //}
					          
				      }

				      function onOpen(evt) {             
				    	  wsocket.send("#{contratoViewController.contratoTO.contrato.autenticacoes.get(0).username}");          
					  }

				      function identificar(){
					      
					  }
					  connect();
					  identificar();
				    
				});
		      
		      
		//]]>
		</script>
		</ui:fragment>	
	</ui:define>

</ui:composition>
